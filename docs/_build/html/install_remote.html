

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Instalación desde ansible remoto &mdash; OMniLeads develop documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Horizontal Cluster Installation" href="install_cluster.html" />
    <link rel="prev" title="Primer acceso a OMniLeads:" href="install_first_access.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> OMniLeads
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="what_is_extra.html">WebRTC; la tecnología subyacente de OMniLeads</a></li>
<li class="toctree-l1"><a class="reference internal" href="what_is_extra.html#caracteristicas-y-funcionalidades-de-omnileads">Características y funcionalidades de OMniLeads</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="what_is_use_cases.html">Plataforma de Contact Center integrado a un PBX basado en SIP</a></li>
<li class="toctree-l1"><a class="reference internal" href="what_is_use_cases.html#compania-de-servicios-de-customer-contact">Compañia de servicios de Customer Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="what_is_use_cases.html#carriers-o-proveedores-de-cloud-pbx">Carriers ó Proveedores de Cloud PBX</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="install.html">Procedimientos de instalación</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="install_self_hosted.html">Ansible Self-Hosted Install</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Instalación desde ansible remoto</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pre-requisitos">Pre-requisitos:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#preparacion-en-la-maquina-que-ejecuta-la-instalacion-remota">Preparación en la máquina que ejecuta la instalación remota:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#preparacion-del-archivo-inventory">Preparación del archivo <em>inventory</em>:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ejecucion-del-script-de-instalacion">Ejecución del script de instalación:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#primer-acceso-a-omnileads">Primer acceso a OMniLeads:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="install_first_access.html">Primer acceso a OMniLeads:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#errores-comunes">Errores comunes:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="install_cluster.html">Horizontal Cluster Installation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="initial_settings.html">Configuración Inicial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="telephony.html">Configuración de acceso a la PSTN</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="campaigns.html">Campañas Telefónicas</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reports.html">Metricas, grabaciones y supervicion</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="maintance.html">OMniLeads Maintenance</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">OMniLeads</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="install.html">Procedimientos de instalación</a> &raquo;</li>
        
      <li>Instalación desde ansible remoto</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/install_remote.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="instalacion-desde-ansible-remoto">
<h1>Instalación desde ansible remoto<a class="headerlink" href="#instalacion-desde-ansible-remoto" title="Permalink to this headline">¶</a></h1>
<p>Este tipo de instalación implica que la descarga del proyecto desde el repositorio y la ejecución del script de instalación se realiza desde
la estación de trabajo del sysadmin, ya que precisamente al estar basada en Ansible la instalación se hace viable éste método.</p>
<p>La ventaja principal de esta opción es que el sysadmin puede instalar y mantener varias instancias de OMniLeads desde un único nodo “deployer”.</p>
<img alt="_images/install_ansible_remote.png" src="_images/install_ansible_remote.png" />
<p><em>Figure 1: remote ansible install</em></p>
<div class="section" id="pre-requisitos">
<h2>Pre-requisitos:<a class="headerlink" href="#pre-requisitos" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Una instancia de GNU/Linux CentOS 7 (minimal), Debian 9 (netinstall) ó Ubuntu Server 18.04</li>
<li>20 GB de espacio en disco</li>
<li>4 GB de memoria RAM</li>
<li>En <em>Ubuntu / Debian</em>; Instalar el paquete sudo, openssh-server y phyton-minimal, permitir login SSH con el usuario root y reiniciar el servicio de ssh para que se tomen los cambios:</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">sudo</span> <span class="n">openssh</span><span class="o">-</span><span class="n">server</span> <span class="n">python</span><span class="o">-</span><span class="n">minimal</span> <span class="o">-</span><span class="n">y</span>
<span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s1">&#39;s/#PermitRootLogin prohibit-password/PermitRootLogin yes/&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">sshd_config</span>
<span class="n">systemctl</span> <span class="n">restart</span> <span class="n">ssh</span>
</pre></div>
</div>
<ul class="simple">
<li>Es muy importante dejar la hora correctamente configurada en el host.</li>
<li>Configurar una <em>dirección IP</em> y un <em>hostname</em> fijo en el host destino de la instalación.</li>
</ul>
</div>
<div class="section" id="preparacion-en-la-maquina-que-ejecuta-la-instalacion-remota">
<h2>Preparación en la máquina que ejecuta la instalación remota:<a class="headerlink" href="#preparacion-en-la-maquina-que-ejecuta-la-instalacion-remota" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Debemos contar con el paquete git para luego clonar el repositorio del protyecto y seleccionar el release a instalar.</li>
</ul>
<p>Ubuntu - Debian:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span> <span class="n">install</span> <span class="n">git</span>
<span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">gitlab</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">omnileads</span><span class="o">/</span><span class="n">ominicontacto</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">ominicontacto</span>
<span class="n">git</span> <span class="n">checkout</span> <span class="n">master</span>
</pre></div>
</div>
<p>CentOS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">yum</span> <span class="n">install</span> <span class="n">git</span>
<span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">gitlab</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">omnileads</span><span class="o">/</span><span class="n">ominicontacto</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">ominicontacto</span>
<span class="n">git</span> <span class="n">checkout</span> <span class="n">master</span>
</pre></div>
</div>
<ul class="simple">
<li>Debemos asegurarnos de contar con una clave pública generada en la carpeta /root/.ssh/</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">ls</span> <span class="o">-</span><span class="n">l</span> <span class="o">/</span><span class="n">root</span><span class="o">/.</span><span class="n">ssh</span><span class="o">/</span>
</pre></div>
</div>
<p>Es probable ya contemos con una clave pública (id_rsa.pub), como se aprecia en la <em>figura 1</em>.</p>
<img alt="_images/install_id_rsa.png" src="_images/install_id_rsa.png" />
<p><em>Figure 1: ls -a /root/.ssh command output</em></p>
<p>En caso de NO disponer de una, se puede generar rápidamente con el siguiente comando:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span><span class="o">/</span><span class="n">install_sshkeygen_remote</span><span class="o">.</span><span class="n">png</span>
</pre></div>
</div>
<img alt="_images/install_sshkeygen_remote.png" src="_images/install_sshkeygen_remote.png" />
<p><em>Figure 2: ssh-keygen command output</em></p>
<p>Este comando genera nuestra clave <em>id_rsa.pub</em> que mencionamos anteriormente.</p>
<ul class="simple">
<li>Se comprueba la <em>dirección IP</em> y <em>hostname</em> que posee el host destino de la instalación, para luego ajustar el archivo <em>inventory</em> que se utiliza a la hora de tomar los parámetros de la instalación.</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hostname</span>
<span class="n">ip</span> <span class="n">a</span>
</pre></div>
</div>
<img alt="_images/install_hostname_command.png" src="_images/install_hostname_command.png" />
<p><em>Figure 3: hostname command output</em></p>
<img alt="_images/install_ip_a_command.png" src="_images/install_ip_a_command.png" />
<p><em>Figure 4: ip a command output</em></p>
</div>
<div class="section" id="preparacion-del-archivo-inventory">
<h2>Preparación del archivo <em>inventory</em>:<a class="headerlink" href="#preparacion-del-archivo-inventory" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>En este paso, se debe editar el archivo <em>inventory</em> (PATH/ominicontacto/deploy/ansible). El mismo reside dentro del repositorio del proyecto, que se generó en la PC del sysadmin que ejecuta el deploy remoto.</li>
</ul>
<p>Nota: OMniLeads utiliza ansible para realizar la instalación, por lo tanto existe un “archivo de inventario” que debe ser modificado de acuerdo a los
parámetros del host sobre el que estamos trabajando.</p>
<p>Localizar la sección <em>[omnileads-aio]</em> y modificar la cadena ‘hostname’ por el hostname de nuestro servidor destino de la instalción. También en
esta sección se debe editar el parámetro ‘X.X.X.X’ con la dirección IP del servidor.</p>
<img alt="_images/install_inventory_file_net_remote.png" src="_images/install_inventory_file_net_remote.png" />
<p><em>Figure 5: inventory file network params section</em></p>
<p>Además dentro del mismo archivo, unas líneas debajo encontraremos la sección <em>[everyyone:vars]</em>, en la cual se pueden alterar variables y contraseñas
que vienen por defecto en el sistema.</p>
<img alt="_images/install_inventory_passwords.png" src="_images/install_inventory_passwords.png" />
<p><em>Figure 6: Passwords and parameters of services</em></p>
<p>Es importante aclarar que cada vez que se corre el script “./deploy.sh” ya sea para instalar, re-instalar, actualizar, modificar la dirección IP de OML, etc.,
el archivo de inventory se vuelve a “cero”. No obstante se genera una copia del archivo (my_inventory), de manera tal que se cuente con los parámetros
del sistema utilizados en la última ejecución del script.
La copia en cuestión se ubica en el path donde ha sido clonado el repositorio de OML y bajo el nombre de “my_inventory” como lo expone la figura 6.</p>
<img alt="_images/install_remote_my_inventory.png" src="_images/install_remote_my_inventory.png" />
<p><em>Figure 7: inevntory copy, my_inventory file</em></p>
</div>
<div class="section" id="ejecucion-del-script-de-instalacion">
<h2>Ejecución del script de instalación:<a class="headerlink" href="#ejecucion-del-script-de-instalacion" title="Permalink to this headline">¶</a></h2>
<p>La instalación de OMniLeads se realiza mediante el script <em>deploy.sh</em>, ubicado dentro de la carpeta deploy/ansible con respecto a la carpeta
raíz del proyecto (ominicontacto).</p>
<p>Una vez configuradas las variables citadas, se procede con la ejecución del script de instalación (uitilizando sudo).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">deploy</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">a</span>
</pre></div>
</div>
<img alt="_images/install_deploysh_remote.png" src="_images/install_deploysh_remote.png" />
<p><em>Figure 7: remote root password</em></p>
<p>La diferencia respecto de la instalación ‘Self-Hosted’, es que el script nos pide la contraseña del usuario <em>root</em> del host
destino de la instalación.</p>
<p>El tiempo de instalación dependerá mayormente de la velocidad de conexión a internet del host sobre ek que se está corriendo el deplot de  OML,
ya que se deben descargar, instalar y configurar varios paquetes correspondientes a los diferentes componentes de software que conforman el sistema.</p>
<p>Si la ejecución de la instalación finaliza exitosamente, se despliega una vista como la de la figura 8.</p>
<img alt="_images/install_ok.png" src="_images/install_ok.png" />
<p><em>Figure 8: OMniLeads installation ended succesfuly</em></p>
</div>
<div class="section" id="primer-acceso-a-omnileads">
<h2>Primer acceso a OMniLeads:<a class="headerlink" href="#primer-acceso-a-omnileads" title="Permalink to this headline">¶</a></h2>
<p>Si la ejecución de la instalación fue exitosa, entonces vamos por el primer acceso a OMniLeads.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="install_first_access.html">Primer acceso a OMniLeads:</a></li>
</ul>
</div>
</div>
<div class="section" id="errores-comunes">
<h2>Errores comunes:<a class="headerlink" href="#errores-comunes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>El server no tiene internet o no resuelve dominios (configuración de DNS).</li>
</ul>
<p><em>Compruebe el acceso a internet del host (por ej: actualizando paquetes - apt-get update | yum update).</em></p>
<ul class="simple">
<li>Timeout de algún paquete que se intenta bajar. Puede volver a intentar ejecutar el deploy y si vuelve a fallar, la opción puede ser</li>
</ul>
<p><em>Instalar el paquete desde la terminal.</em></p>
<ul class="simple">
<li>Falla por mala sintaxis o falta de definición de <em>hostname</em> y <em>dirección IP</em> en el archivo <em>inventory</em>.</li>
</ul>
<p><em>Revisar archivo inventorys</em></p>
<ul class="simple">
<li>No se configuró correctamente el acceso ssh del host destino de la instalación.</li>
</ul>
<p><em>Revisar estado del firewall. Comprobar acceso remoto por ssh con el usuario root</em></p>
<ul class="simple">
<li>En caso de contar con algún host Ubuntu-Debian, recordar que se deben instalar paquetes como <em>sudo, openssh-server o python-minimal</em> antes de correr el script de <em>deploy.sh</em></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="install_cluster.html" class="btn btn-neutral float-right" title="Horizontal Cluster Installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="install_first_access.html" class="btn btn-neutral float-left" title="Primer acceso a OMniLeads:" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, omnileads

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>