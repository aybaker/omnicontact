{% extends "base.html" %}
{% load static %}

{% block content %}
    <div class="panel panel-default">
        <!-- Default panel contents -->
        <div class="panel-heading">                
            <h4 class="inline">Detalle Reporte</h4>
            <div class="clear-fix"></div>
        </div>

        <div class="panel-body">
            <div class="col-lg-12"> 
                <table class="table table-condensed">
                    <thead>
                        <th>Campaña</th>
                        <th>Fecha Desde</th>
                        <th>Fecha Hasta</th>                     
                        <th>Base Datos</th>
                        <th>Estado</th>
                    </thead>
                    <tbody>
                        <tr class="info">
                            <td><strong>{{ campana.nombre }}</strong></td>
                            <td>
                                {{ campana.fecha_inicio|date:"d/m/Y" }}
                            </td>
                            <td>
                                {{ campana.fecha_fin|date:"d/m/Y" }}
                            </td>
                            <td>
                                {{ campana.bd_contacto }} 
                                ({{ campana.obtener_estadisticas.total_contactos }} Contactos)
                            </td>
                            <td>{{ campana.get_estado_display }}</td>
                        </tr>
                    </tbody>
                </table>

                <table class="table table-bordered">
                    <tbody>
                        <tr>
                            <td  width="50%">
                                <table class="table table-bordered">
                                    <tbody>
                                        <tr>
                                            <td><h5>Cantidad Total Contestadas</h5></td>
                                            <td><h5><span class="label label-primary">{{ campana.obtener_estadisticas.cantidad_contestadas }}</span></h5></td>
                                        </tr>

                                        <tr>
                                            <td><h5>Cantidad Total No Contestadas</h5></td>
                                            <td><h5><span class="label label-primary">{{ campana.obtener_estadisticas.cantidad_no_contestadas }}</span></h5></td>
                                        </tr>

                                         <tr>
                                            <td><h5>Cantidad Total Pendientes</h5></td>
                                            <td><h5><span class="label label-primary">{{ campana.obtener_estadisticas.cantidad_pendientes }}</span></h5></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </td>
                            <td align="center">
                                {% if campana.url_grafico_torta %}
                                    <figure>
                                        <embed type="image/svg+xml" src="{{ campana.url_grafico_torta }}" height="400"/>
                                    </figure>
                                {% else%} 
                                    <p class="text-center text-danger">
                                        <em>El reporte gráfico no fue generado.</em>
                                    </p>
                                {% endif %}
                            </td>
                        </tr>
                    </tbody>
                </table>

                <table class="table table-bordered">
                    <tbody>
                        <tr>
                            <td width="50%">
                                <table class="table table-bordered table-hover">
                                    <tbody>

                                        {% for opcion_campana in campana.opciones.all %}
                                            <tr>
                                                <td><h5>#{{ opcion_campana.digito }}</h5></td>
                                                <td><h5>{{ opcion_campana.get_accion_display }}</h5></td>
                                                <td>
                                                {% if opcion_campana.grupo_atencion %}
                                                     Grupo Atención: <strong>{{ opcion_campana.grupo_atencion }}</strong>
                                                {% endif %}

                                                {% if opcion_campana.calificacion %}
                                                    Calificación: <strong>{{ opcion_campana.calificacion }}</strong>
                                                {% endif %}
                                                </td>
                                                <td width="10%">
                                                    <h5>
                                                        <span class="label label-primary">
                                                            {% for opcion, cantidad in campana.obtener_estadisticas.opcion_x_cantidad.items %}
                                                                {% if opcion == opcion_campana.digito %}
                                                                    {{ cantidad }}
                                                                {% endif %}
                                                            {% endfor %}
                                                        </span>
                                                    </h5>
                                                </td>
                                            </tr>
                                        {% empty %}
                                            <tr>
                                                <td colspan="3">
                                                    <p class="text-center text-danger">
                                                        <em>No se encontraron Opciones creadas.</em>
                                                    </p>
                                                </td>
                                            </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </td>
                            <td align="center">
                                {% if campana.url_grafico_torta_opciones %}
                                    <figure>
                                        <embed type="image/svg+xml" src="{{ campana.url_grafico_torta_opciones }}" height="400"/>
                                    </figure>
                                {% else%} 
                                    <p class="text-center text-danger">
                                        <em>El reporte gráfico no fue generado.</em>
                                    </p>
                                {% endif %}
                            </td>
                        </tr>
                    </tbody>
                </table>

                <table class="table table-bordered">
                    <tbody>
                        <tr>
                            <td width="50%">
                                <table class="table table-bordered">
                                    <tbody>
                                        {% for intentos, cantidad in campana.obtener_estadisticas.dic_intento_x_contactos.items %}
                                            <tr>
                                                <td><h5>{{ intentos }} Intentos</h5></td>
                                                <td width="10%"><h5><span class="label label-primary">{{ cantidad }}</span></h5></td>
                                            </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </td>
                            <td align="center">
                                {% if campana.url_grafico_barra_intentos %}
                                    <figure>
                                        <embed type="image/svg+xml" src="{{ campana.url_grafico_barra_intentos }}" height="400"/>
                                    </figure>
                                {% else%} 
                                    <p class="text-center text-danger">
                                        <em>El reporte gráfico no fue generado.</em>
                                    </p>
                                {% endif %}
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock %}